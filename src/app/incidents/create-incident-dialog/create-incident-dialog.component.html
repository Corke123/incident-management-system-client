<form [formGroup]="incidentForm" (ngSubmit)="onSubmit()">
  <h1 mat-dialog-title>Create Incident</h1>
  <mat-divider></mat-divider>
  <mat-dialog-content>
    <div fxLayout="row" fxLayoutAlign="space-between" fxLayoutGap="8px">
      <div fxFlex="50" fxLayout="column" fxLayoutGap="8px">
        <mat-form-field fxFlex="50">
          <mat-label>Description</mat-label>
          <textarea
            [rows]="6"
            matInput
            id="description"
            formControlName="description"
            #description
          ></textarea>
          <mat-hint align="end">{{ description.value.length }}/2048</mat-hint>
          <mat-error
            *ngIf="incidentForm.get('description')?.hasError('required')"
            >Description is required</mat-error
          >
          <mat-error
            *ngIf="incidentForm.get('description')?.hasError('maxlength')"
            >Description maximum length is 2048 characters</mat-error
          >
        </mat-form-field>
        <div
          fxLayout="column"
          fxLayoutAlign="start center"
          class="image-container"
        >
          <input
            type="file"
            style="display: none"
            (change)="onFileSelected($event)"
            #fileInput
          />
          <button
            mat-button
            type="button"
            color="primary"
            (click)="fileInput.click()"
          >
            Choose Image
          </button>
          <div class="image-container">
            <img [src]="url" alt="" />
          </div>
        </div>
      </div>
      <div fxLayout="column">
        <google-map
          *ngIf="apiLoaded | async"
          [center]="center"
          [zoom]="zoom"
          (mapClick)="addMarker($event)"
        >
          <map-marker [position]="{ lat, lng }"></map-marker>
        </google-map>
        <mat-hint>Click on map to set incident location</mat-hint>
      </div>
    </div>
  </mat-dialog-content>
  <mat-dialog-actions
    fxLayout="row"
    fxLayoutAlign="end"
    fxLayoutGap="8px"
    class="dialog-actions"
  >
    <button mat-button mat-dialog-close color="primary" type="button">
      Cancel
    </button>
    <button mat-raised-button color="primary" [disabled]="incidentForm.invalid">
      Submit
    </button>
  </mat-dialog-actions>
</form>
